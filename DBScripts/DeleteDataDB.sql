BEGIN
    FOR D IN ( SELECT TABLE_NAME, CONSTRAINT_NAME
               FROM USER_CONSTRAINTS
               WHERE CONSTRAINT_TYPE = 'R' )
    LOOP
        EXECUTE IMMEDIATE 'ALTER TABLE '||D.TABLE_NAME
                          ||' DROP CONSTRAINT '||D.CONSTRAINT_NAME;
    END LOOP;
END;
/

BEGIN
   FOR reg IN (SELECT table_name FROM user_tables WHERE table_name 
   IN ('AUTHOR', 'AUTHOR_BOOK', 'BOOK', 'BOOK_COPY', 'BORROW', 'CATEGORY', 'COMMENTS', 'KEYWORDS', 
   'KEYWORDS_BOOK', 'LANGUAGE', 'MESSAGE', 'PUBLISHER', 'REJECT_REASON', 'REQUEST', 'TYPES', 'USER_ROLE', 'USERS')) 
   LOOP
      EXECUTE IMMEDIATE 'TRUNCATE TABLE ' || reg.table_name;
   END LOOP;
END;
/

ALTER TABLE AUTHOR_BOOK
ADD CONSTRAINT AUTHOR_BOOK_FK_AUTHOR FOREIGN KEY
(
  AUTHOR_ID 
)
REFERENCES AUTHOR
(
  AUTHOR_ID 
)
ENABLE;

ALTER TABLE AUTHOR_BOOK
ADD CONSTRAINT AUTHOR_BOOK_FK_BOOK FOREIGN KEY
(
  BOOK_ID 
)
REFERENCES BOOK
(
  BOOK_ID 
)
ENABLE;

ALTER TABLE BOOK_COPY
ADD CONSTRAINT BOOK_COPY_FK_BOOK FOREIGN KEY
(
  BOOK_ID 
)
REFERENCES BOOK
(
  BOOK_ID 
)
ENABLE;

ALTER TABLE BOOK_COPY
ADD CONSTRAINT BOOK_COPY_FK_USERS FOREIGN KEY
(
  USER_ID 
)
REFERENCES USERS
(
  USER_ID 
)
ENABLE;

ALTER TABLE BOOK
ADD CONSTRAINT BOOK_FK_CATEGORY FOREIGN KEY
(
  CATEGORY_ID 
)
REFERENCES CATEGORY
(
  CATEGORY_ID 
)
ENABLE;

ALTER TABLE BOOK
ADD CONSTRAINT BOOK_FK_LANGUAGE FOREIGN KEY
(
  LANGUAGE_ID 
)
REFERENCES LANGUAGE
(
  LANGUAGE_ID 
)
ENABLE;

ALTER TABLE BOOK
ADD CONSTRAINT BOOK_FK_PUBLISHER FOREIGN KEY
(
  PUBLISHER_ID 
)
REFERENCES PUBLISHER
(
  PUBLISHER_ID 
)
ENABLE;

ALTER TABLE BOOK
ADD CONSTRAINT BOOK_FK_USERS FOREIGN KEY
(
  REGISTERED_BY 
)
REFERENCES USERS
(
  USER_ID 
)
ENABLE;

ALTER TABLE BORROW
ADD CONSTRAINT BORROW_FK_BOOK_COPY FOREIGN KEY
(
  BOOK_COPY_ID
)
REFERENCES BOOK_COPY
(
  BOOK_COPY_ID 
)
ENABLE;

ALTER TABLE BORROW
ADD CONSTRAINT BORROW_FK_USERS FOREIGN KEY
(
  ADMIN_RETURN_ID 
)
REFERENCES USERS
(
  USER_ID 
)
ENABLE;

ALTER TABLE BORROW
ADD CONSTRAINT BORROW_FK_REQUEST FOREIGN KEY
(
  BORROW_ID 
)
REFERENCES REQUEST
(
  REQUEST_ID 
)
ENABLE;

ALTER TABLE COMMENTS
ADD CONSTRAINT COMMENTS_FK_BOOK FOREIGN KEY
(
  BOOK_ID 
)
REFERENCES BOOK
(
  BOOK_ID 
)
ENABLE;

ALTER TABLE COMMENTS
ADD CONSTRAINT COMMENTS_FK_COMMENTS FOREIGN KEY
(
  PARENT_ID 
)
REFERENCES COMMENTS
(
  COMMENT_ID 
)
ENABLE;

ALTER TABLE COMMENTS
ADD CONSTRAINT COMMENTS_FK_USERS FOREIGN KEY
(
  USER_ID 
)
REFERENCES USERS
(
  USER_ID 
)
ENABLE;

ALTER TABLE KEYWORDS_BOOK
ADD CONSTRAINT KEYWORDS_BOOK_FK_BOOK FOREIGN KEY
(
  BOOK_ID 
)
REFERENCES BOOK
(
  BOOK_ID 
)
ENABLE;

ALTER TABLE KEYWORDS_BOOK
ADD CONSTRAINT KEYWORDS_BOOK_FK_KW FOREIGN KEY
(
  KEYWORDS_ID 
)
REFERENCES KEYWORDS
(
  KEYWORDS_ID 
)
ENABLE;

ALTER TABLE MESSAGE
ADD CONSTRAINT MESSAGE_FK_FROM_USER FOREIGN KEY
(
  FROM_USER_ID 
)
REFERENCES USERS
(
  USER_ID 
)
ENABLE;

ALTER TABLE MESSAGE
ADD CONSTRAINT MESSAGE_FK_TO_USER FOREIGN KEY
(
  TO_USER_ID 
)
REFERENCES USERS
(
  USER_ID 
)
ENABLE;

ALTER TABLE REQUEST
ADD CONSTRAINT REQUEST_FK_ADMIN FOREIGN KEY
(
  ADMIN_ID 
)
REFERENCES USERS
(
  USER_ID 
)
ENABLE;

ALTER TABLE REQUEST
ADD CONSTRAINT REQUEST_FK_BOOK FOREIGN KEY
(
  BOOK_ID 
)
REFERENCES BOOK
(
  BOOK_ID 
)
ENABLE;

ALTER TABLE REQUEST
ADD CONSTRAINT REQUEST_FK_REJECT_REASON FOREIGN KEY
(
  REJECT_REASON_ID 
)
REFERENCES REJECT_REASON
(
  REJECT_REASON_ID 
)
ENABLE;

ALTER TABLE REQUEST
ADD CONSTRAINT REQUEST_FK_TYPE FOREIGN KEY
(
  TYPE_ID 
)
REFERENCES TYPES
(
  TYPE_ID 
)
ENABLE;

ALTER TABLE REQUEST
ADD CONSTRAINT REQUEST_FK_USERS FOREIGN KEY
(
  USER_ID 
)
REFERENCES USERS
(
  USER_ID 
)
ENABLE;

ALTER TABLE USERS 
ADD CONSTRAINT USERS_FK_USER_ROLE FOREIGN KEY 
(
  USER_ROLE_ID
)
REFERENCES USER_ROLE
(
  USER_ROLE_ID
)
ENABLE;

COMMIT;